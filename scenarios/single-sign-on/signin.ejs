<%- include(commonPath + '/header.ejs') %>

<div class="container mx-auto py-8">
    <h1 class="text-3xl font-bold mb-4 text-center">ðŸš§ Single Sign-On Demo</h1>
    <div class="text-center">
        <button id="signInButton" class="bg-blue-500 text-white font-bold py-2 px-4 rounded-full inline-block">Sign In</button>
    </div>
</div>

<script>
	document.getElementById('signInButton').addEventListener('click', function() {
		const win = window.open('<%= protocol %>://<%= domainC %>/single-sign-on/login', 'Login to SSO', 'width=500,height=500');
		window.addEventListener('message', function(event) {
			if (event.origin !== '<%= protocol %>://<%= domainC %>') return;
			// Expected structure of event.data: { action: 'login', email: 'user@email.com' }
			if (event.data.action === 'login') {
				// Set the cookie for domainC here using fetch or other methods.
				// Redirect to profile or another route as needed.
				document.cookie = `email=${event.data.email}; max-age=900000`;
				window.location.href = '/single-sign-on/profile';
			}
		}, false);
	});
</script>

<%- include(commonPath + '/footer.ejs') %>
